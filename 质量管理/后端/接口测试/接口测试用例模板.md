# 接口测试用例模板

## 测试用例基本信息

| 字段 | 值 |
|------|-----|
| **用例编号** | API-TC-001 |
| **用例名称** | 用户登录接口测试 |
| **所属模块** | 用户服务 |
| **优先级** | 高 |
| **创建人** | |
| **创建日期** | |

## 接口信息

| 字段 | 值 |
|------|-----|
| **接口名称** | 用户登录 |
| **请求方法** | POST |
| **接口地址** | `{{gateway_url}}/api/auth/login` |
| **请求头** | `Content-Type: application/json` |

## 请求参数

### 请求体 (JSON)
```json
{
  "username": "{{username}}",
  "password": "{{password}}"
}
```

## 测试步骤

### 前置条件
1. 用户服务正常运行
2. 数据库中有测试用户数据
3. Postman 环境配置正确

### 执行步骤
1. 设置请求头：`Content-Type: application/json`
2. 设置请求体参数
3. 发送 POST 请求到登录接口
4. 验证响应结果

## 预期结果

### 响应状态码
- **HTTP 200** - 登录成功

### 响应体结构
```json
{
  "code": 200,
  "message": "登录成功",
  "data": {
    "accessToken": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "refreshToken": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "userId": "123456",
    "username": "testuser"
  }
}
```

### 验证点
- [ ] 响应状态码为 200
- [ ] 响应包含 accessToken
- [ ] 响应包含 refreshToken
- [ ] 响应包含 userId
- [ ] 响应包含 username
- [ ] Token 被正确设置到环境变量

## 测试脚本

### Pre-request Script
```javascript
// 前置脚本 - 可选
console.log("开始执行用户登录测试");
```

### Tests Script
```javascript
// 验证响应状态码
pm.test("状态码应为 200", function () {
    pm.response.to.have.status(200);
});

// 验证响应结构
pm.test("响应应包含标准结构", function () {
    var jsonData = pm.response.json();
    pm.expect(jsonData).to.have.property('code');
    pm.expect(jsonData).to.have.property('message');
    pm.expect(jsonData).to.have.property('data');
});

// 验证登录成功
pm.test("登录成功", function () {
    var jsonData = pm.response.json();
    pm.expect(jsonData.code).to.equal(200);
    pm.expect(jsonData.message).to.equal("登录成功");
});

// 验证 Token 存在
pm.test("响应包含访问令牌", function () {
    var jsonData = pm.response.json();
    pm.expect(jsonData.data.accessToken).to.not.be.undefined;
    pm.expect(jsonData.data.refreshToken).to.not.be.undefined;
});

// 设置环境变量
pm.test("设置环境变量", function () {
    var jsonData = pm.response.json();
    pm.environment.set("bearer_token", jsonData.data.accessToken);
    pm.environment.set("refresh_token", jsonData.data.refreshToken);
    pm.environment.set("user_id", jsonData.data.userId);
});
```

## 异常测试用例

### 用例 1: 用户名错误
**请求体:**
```json
{
  "username": "wronguser",
  "password": "{{password}}"
}
```
**预期结果:**
- 状态码: 401
- 错误信息: "用户名或密码错误"

### 用例 2: 密码错误
**请求体:**
```json
{
  "username": "{{username}}",
  "password": "wrongpassword"
}
```
**预期结果:**
- 状态码: 401
- 错误信息: "用户名或密码错误"

### 用例 3: 参数缺失
**请求体:**
```json
{
  "username": "{{username}}"
}
```
**预期结果:**
- 状态码: 400
- 错误信息: "密码不能为空"

## 测试结果记录

| 测试轮次 | 执行人 | 执行时间 | 结果 | 备注 |
|----------|--------|----------|------|------|
| 第1轮 | | | 通过/失败 | |
| 第2轮 | | | 通过/失败 | |

## 问题记录

| 问题描述 | 严重程度 | 状态 | 解决方案 |
|----------|----------|------|----------|
| | | | |

---

## 使用说明

1. **复制模板**: 为每个接口创建新的测试用例文件
2. **填写信息**: 根据实际接口信息修改模板内容
3. **执行测试**: 在 Postman 中执行测试用例
4. **记录结果**: 填写测试结果和问题记录
5. **归档管理**: 将完成的测试用例归档到相应模块目录
